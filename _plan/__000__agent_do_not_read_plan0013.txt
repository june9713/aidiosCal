# Plan 0013: 브라우저 종료 후 로그인 상태 유지 문제 해결

## 목표
브라우저를 종료하고 다시 접속해도 로그인 상태가 유지되도록 하여 사용자 편의성 향상

## 문제 분석
1. **현재 상황**:
   - JWT 토큰을 localStorage에 저장하여 인증 관리
   - 토큰 만료 시간은 43200분 (30일)으로 충분히 길게 설정됨
   - localStorage는 브라우저 종료 후에도 유지되어야 하는데 실제로는 로그아웃됨

2. **예상 원인**:
   - localStorage의 데이터가 실제로는 유지되지만 애플리케이션 로직에서 세션을 제대로 복원하지 못함
   - 토큰 검증 로직에서 문제가 있을 가능성
   - 토큰 갱신 로직이 페이지 로드 시점에서 작동하지 않을 가능성

## 해결 방안

### 1단계: 현재 상태 분석
- 브라우저 개발자 도구에서 localStorage 상태 확인
- 페이지 로드 시 토큰 검증 로직 확인
- 토큰 만료 검사 함수 검증

### 2단계: 세션 복원 로직 강화
- DOMContentLoaded 이벤트에서 토큰 유효성 검사 개선
- JWT 토큰 디코딩 및 만료 시간 검증 강화
- 토큰이 유효한 경우 자동 로그인 처리

### 3단계: 추가 보안 조치
- Remember Me 기능 추가 (선택적)
- 쿠키를 이용한 보조 인증 메커니즘 구현
- 리프레시 토큰 메커니즘 구현

### 4단계: 백엔드 지원
- 토큰 리프레시 엔드포인트 구현
- 장기 세션 관리를 위한 쿠키 설정

## 실행 단계
1. ✅ 계획 수립
2. ✅ 현재 localStorage 상태 및 토큰 검증 로직 분석
3. ✅ main.js의 DOMContentLoaded 이벤트 핸들러 개선
4. ✅ JWT 토큰 검증 함수 개선
5. ✅ 백엔드 쿠키 지원 및 세션 체크 엔드포인트 구현
6. 🔄 테스트 및 검증

## 예상 결과
- 브라우저 종료 후 재접속 시에도 로그인 상태 유지
- 토큰 만료 시 자동 갱신 또는 적절한 로그아웃 처리
- 사용자 경험 개선

## 주의사항
- 보안상 토큰의 만료 시간을 너무 길게 설정하지 않도록 주의
- 토큰 갱신 실패 시 적절한 에러 처리
- localStorage와 sessionStorage의 차이점 고려 