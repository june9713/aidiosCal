<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê³µë™ì‘ì—…ì ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 6px;
        }
        .test-button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background-color: #0056b3;
        }
        .result-area {
            margin-top: 15px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 4px;
            border: 1px solid #dee2e6;
            min-height: 100px;
        }
        .schedule-info-table {
            display: grid;
            grid-template-columns: 120px 1fr;
            gap: 0;
            background: #f8f9fa;
            border-radius: 6px;
            border: 1px solid #dee2e6;
            overflow: hidden;
            margin-top: 20px;
        }
        .schedule-info-label {
            font-weight: 600;
            color: #000;
            padding: 6px 12px;
            border-bottom: 1px solid #dee2e6;
            border-right: 1px solid #dee2e6;
            display: flex;
            align-items: center;
            font-size: 13px;
            line-height: 1.2;
            min-height: 32px;
            background: #e9ecef;
        }
        .schedule-info-value {
            padding: 6px 12px;
            color: #000;
            border-bottom: 1px solid #dee2e6;
            display: flex;
            align-items: center;
            font-size: 13px;
            line-height: 1.2;
            min-height: 32px;
            background: white;
        }
        .schedule-info-value:last-of-type,
        .schedule-info-label:last-of-type {
            border-bottom: none;
        }
        .collaborator-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 4px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        .collaborator-item:last-child {
            border-bottom: none;
        }
        .collaborator-name {
            font-weight: 500;
            color: #333;
            min-width: 80px;
        }
        .collaborator-role {
            background-color: #e3f2fd;
            color: #1976d2;
            padding: 2px 6px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
        }
        .collaborator-permissions {
            color: #666;
            font-size: 11px;
            font-style: italic;
        }
        .no-collaborators {
            color: #999;
            font-style: italic;
            font-size: 12px;
        }
        .loading-collaborators {
            color: #666;
            font-style: italic;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ê³µë™ì‘ì—…ì ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</h1>
        
        <div class="test-section">
            <h3>1. ê³µë™ì‘ì—…ì ë Œë”ë§ í…ŒìŠ¤íŠ¸</h3>
            <button class="test-button" onclick="testRenderCollaborators()">ê³µë™ì‘ì—…ì ë Œë”ë§ í…ŒìŠ¤íŠ¸</button>
            <div class="result-area" id="render-test-result">
                ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
            </div>
        </div>

        <div class="test-section">
            <h3>2. ìŠ¤ì¼€ì¤„ ìƒì„¸ ì •ë³´ í…ŒìŠ¤íŠ¸</h3>
            <button class="test-button" onclick="testScheduleDetail()">ìŠ¤ì¼€ì¤„ ìƒì„¸ ì •ë³´ í…ŒìŠ¤íŠ¸</button>
            <div class="result-area" id="schedule-detail-result">
                ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
            </div>
        </div>

        <div class="test-section">
            <h3>3. API í˜¸ì¶œ ì‹œë®¬ë ˆì´ì…˜</h3>
            <button class="test-button" onclick="testAPICall()">API í˜¸ì¶œ ì‹œë®¬ë ˆì´ì…˜</button>
            <div class="result-area" id="api-test-result">
                ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
            </div>
        </div>
    </div>

    <script>
        // ê³µë™ì‘ì—…ì ë Œë”ë§ í•¨ìˆ˜ (main.jsì—ì„œ ê°€ì ¸ì˜¨ ê²ƒ)
        function renderCollaboratorsForModal(collaborators, scheduleId) {
            const collaboratorsList = document.getElementById('collaborators-list');
            if (!collaboratorsList) return;
            
            if (collaborators.length === 0) {
                collaboratorsList.innerHTML = '<span class="no-collaborators">ê³µë™ì‘ì—…ìê°€ ì—†ìŠµë‹ˆë‹¤</span>';
                return;
            }
            
            const collaboratorsHtml = collaborators.map(collaborator => {
                const permissions = [];
                if (collaborator.can_edit) permissions.push('ìˆ˜ì •');
                if (collaborator.can_delete) permissions.push('ì‚­ì œ');
                if (collaborator.can_complete) permissions.push('ì™„ë£Œ');
                if (collaborator.can_share) permissions.push('ê³µìœ ');
                
                const permissionsText = permissions.length > 0 ? ` (${permissions.join(', ')})` : '';
                
                return `
                    <div class="collaborator-item">
                        <span class="collaborator-name">${collaborator.name || collaborator.username}</span>
                        <span class="collaborator-role">${collaborator.role || 'í˜‘ì—…ì'}</span>
                        <span class="collaborator-permissions">${permissionsText}</span>
                    </div>
                `;
            }).join('');
            
            collaboratorsList.innerHTML = collaboratorsHtml;
        }

        // í…ŒìŠ¤íŠ¸ 1: ê³µë™ì‘ì—…ì ë Œë”ë§ í…ŒìŠ¤íŠ¸
        function testRenderCollaborators() {
            const resultArea = document.getElementById('render-test-result');
            
            // í…ŒìŠ¤íŠ¸ìš© ê³µë™ì‘ì—…ì ë°ì´í„°
            const testCollaborators = [
                {
                    user_id: 1,
                    username: "user1",
                    name: "ê¹€ì² ìˆ˜",
                    can_edit: true,
                    can_delete: false,
                    can_complete: true,
                    can_share: true,
                    role: "collaborator",
                    added_at: "2025-01-01T00:00:00"
                },
                {
                    user_id: 2,
                    username: "user2",
                    name: "ì´ì˜í¬",
                    can_edit: true,
                    can_delete: true,
                    can_complete: true,
                    can_share: false,
                    role: "manager",
                    added_at: "2025-01-02T00:00:00"
                }
            ];

            // í…ŒìŠ¤íŠ¸ìš© HTML ìƒì„±
            const testHTML = `
                <div class="schedule-info-table">
                    <div class="schedule-info-label">í”„ë¡œì íŠ¸ëª…</div>
                    <div class="schedule-info-value">í…ŒìŠ¤íŠ¸ í”„ë¡œì íŠ¸</div>
                    <div class="schedule-info-label">ì¼ì •ëª…</div>
                    <div class="schedule-info-value">í…ŒìŠ¤íŠ¸ ì¼ì •</div>
                    <div class="schedule-info-label">ì‘ì„±ì</div>
                    <div class="schedule-info-value">í™ê¸¸ë™</div>
                    <div class="schedule-info-label">ê³µë™ì‘ì—…ì</div>
                    <div class="schedule-info-value" id="collaborators-list">
                        <div class="loading-collaborators">ë¡œë”© ì¤‘...</div>
                    </div>
                </div>
            `;

            resultArea.innerHTML = testHTML;
            
            // ê³µë™ì‘ì—…ì ë Œë”ë§ í…ŒìŠ¤íŠ¸
            setTimeout(() => {
                renderCollaboratorsForModal(testCollaborators, 1);
                resultArea.innerHTML += '<p style="color: green; margin-top: 10px;">âœ… ê³µë™ì‘ì—…ì ë Œë”ë§ í…ŒìŠ¤íŠ¸ ì™„ë£Œ!</p>';
            }, 1000);
        }

        // í…ŒìŠ¤íŠ¸ 2: ìŠ¤ì¼€ì¤„ ìƒì„¸ ì •ë³´ í…ŒìŠ¤íŠ¸
        function testScheduleDetail() {
            const resultArea = document.getElementById('schedule-detail-result');
            
            const testSchedule = {
                id: 1,
                title: "í…ŒìŠ¤íŠ¸ ìŠ¤ì¼€ì¤„",
                project_name: "í…ŒìŠ¤íŠ¸ í”„ë¡œì íŠ¸",
                owner: { name: "í™ê¸¸ë™" },
                priority: "high",
                due_time: "2025-01-15T14:00:00",
                alarm_time: "2025-01-15T13:00:00",
                is_completed: false,
                individual: false,
                content: "ì´ê²ƒì€ í…ŒìŠ¤íŠ¸ ìŠ¤ì¼€ì¤„ì…ë‹ˆë‹¤."
            };

            const scheduleDetailHTML = `
                <div class="schedule-info-table">
                    <div class="schedule-info-label">í”„ë¡œì íŠ¸ëª…</div>
                    <div class="schedule-info-value">${testSchedule.project_name}</div>
                    <div class="schedule-info-label">ì¼ì •ëª…</div>
                    <div class="schedule-info-value">${testSchedule.title}</div>
                    <div class="schedule-info-label">ì‘ì„±ì</div>
                    <div class="schedule-info-value">${testSchedule.owner.name}</div>
                    <div class="schedule-info-label">ê³µë™ì‘ì—…ì</div>
                    <div class="schedule-info-value" id="collaborators-list-2">
                        <div class="loading-collaborators">ë¡œë”© ì¤‘...</div>
                    </div>
                    <div class="schedule-info-label">ìš°ì„ ìˆœìœ„</div>
                    <div class="schedule-info-value">${testSchedule.priority}</div>
                    <div class="schedule-info-label">ë§ˆê°ì‹œê°„</div>
                    <div class="schedule-info-value">${testSchedule.due_time}</div>
                    <div class="schedule-info-label">ì•ŒëŒì‹œê°„</div>
                    <div class="schedule-info-value">${testSchedule.alarm_time}</div>
                    <div class="schedule-info-label">ìƒíƒœ</div>
                    <div class="schedule-info-value">${testSchedule.is_completed ? 'ì™„ë£Œ' : 'ë¯¸ì™„ë£Œ'}</div>
                    <div class="schedule-info-label">ê°œì¸ì¼ì •</div>
                    <div class="schedule-info-value">${testSchedule.individual ? 'ğŸ”’ ê°œì¸ì¼ì •' : 'ê³µê°œì¼ì •'}</div>
                    <div class="schedule-info-label">ë‚´ìš©</div>
                    <div class="schedule-info-value">${testSchedule.content}</div>
                </div>
            `;

            resultArea.innerHTML = scheduleDetailHTML;
            
            // ê³µë™ì‘ì—…ì ë°ì´í„° ì‹œë®¬ë ˆì´ì…˜
            setTimeout(() => {
                const emptyCollaborators = [];
                renderCollaboratorsForModal(emptyCollaborators, 1);
                
                // collaborators-list-2ë¥¼ ì°¾ì•„ì„œ ì—…ë°ì´íŠ¸
                const collaboratorsList2 = document.getElementById('collaborators-list-2');
                if (collaboratorsList2) {
                    if (emptyCollaborators.length === 0) {
                        collaboratorsList2.innerHTML = '<span class="no-collaborators">ê³µë™ì‘ì—…ìê°€ ì—†ìŠµë‹ˆë‹¤</span>';
                    }
                }
                
                resultArea.innerHTML += '<p style="color: green; margin-top: 10px;">âœ… ìŠ¤ì¼€ì¤„ ìƒì„¸ ì •ë³´ í…ŒìŠ¤íŠ¸ ì™„ë£Œ!</p>';
            }, 1000);
        }

        // í…ŒìŠ¤íŠ¸ 3: API í˜¸ì¶œ ì‹œë®¬ë ˆì´ì…˜
        function testAPICall() {
            const resultArea = document.getElementById('api-test-result');
            
            resultArea.innerHTML = '<p>API í˜¸ì¶œ ì‹œë®¬ë ˆì´ì…˜ ì¤‘...</p>';
            
            // ê°€ìƒì˜ API ì‘ë‹µ ì‹œë®¬ë ˆì´ì…˜
            setTimeout(() => {
                const mockResponse = {
                    status: 200,
                    data: [
                        {
                            user_id: 3,
                            username: "user3",
                            name: "ë°•ë¯¼ìˆ˜",
                            can_edit: true,
                            can_delete: true,
                            can_complete: true,
                            can_share: true,
                            role: "admin",
                            added_at: "2025-01-03T00:00:00"
                        }
                    ]
                };

                if (mockResponse.status === 200) {
                    const collaborators = mockResponse.data;
                    resultArea.innerHTML = `
                        <p style="color: green;">âœ… API í˜¸ì¶œ ì„±ê³µ!</p>
                        <p>ì‘ë‹µ ë°ì´í„°:</p>
                        <pre>${JSON.stringify(collaborators, null, 2)}</pre>
                        <p>ê³µë™ì‘ì—…ì ìˆ˜: ${collaborators.length}ëª…</p>
                    `;
                } else {
                    resultArea.innerHTML = '<p style="color: red;">âŒ API í˜¸ì¶œ ì‹¤íŒ¨</p>';
                }
            }, 1500);
        }
    </script>
</body>
</html>
